(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{65:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(21),s=n.n(a),l=n(7),o=n(3),i=n(8),u=n.n(i),j=n(14),d=n(5),b=Object(c.createContext)(),O=n(2),p="ADMIN_LOADED",h="AUTH_ERROR",x="LOGIN_SUCCESS",f="LOGIN_FAIL",m="LOGOUT",v="CLEAR_ERRORS",g="GET_CLIENTS",y="DELETE_CLIENTS",C="CLIENTS_ERROR",k="CLEAR_CLIENTS",E="GET_USERS",N="SET_CURRENT",S="USERS_ERROR",A="CLEAR_USERS",w="GENERATE_CSV",R="GENERATE_CSV_ONEUSER",_="CLEAR_CSV",U=function(e,t){switch(t.type){case p:return Object(O.a)(Object(O.a)({},e),{},{isAuthenticated:!0,loading:!1,admin:t.payload});case x:return localStorage.setItem("token",t.payload.token),Object(O.a)(Object(O.a)(Object(O.a)({},e),t.payload),{},{isAuthenticated:!0,loading:!1});case f:return localStorage.removeItem("token"),Object(O.a)(Object(O.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,admin:null,error:t.payload});case h:case m:return localStorage.removeItem("token"),Object(O.a)(Object(O.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,admin:null,error:null});case v:if(!t.payload)return Object(O.a)(Object(O.a)({},e),{},{error:null});var n=null;return e.error&&(void 0===(n=t.payload.forEach((function(t){return e.error.filter((function(e){return e.id!==t}))})))&&(n=null),console.log("errFiltered",n)),Object(O.a)(Object(O.a)({},e),{},{error:n});default:return e}},T=n(12),L=n.n(T),D=function(e){e?L.a.defaults.headers.common["x-auth-token"]=e:delete L.a.defaults.headers.common["x-auth-token"]},F=n(0),I=function(e){var t={token:localStorage.getItem("token"),isAuthenticated:!1,loading:!0,admin:null,error:null},n=Object(c.useReducer)(U,t),r=Object(d.a)(n,2),a=r[0],s=r[1],l=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.token&&D(localStorage.token),e.prev=1,e.next=4,L.a.get("/api/auth");case 4:t=e.sent,s({type:p,payload:t.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),s({type:h});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,L.a.post("/api/auth",t,n);case 4:c=e.sent,i(),s({type:x,payload:c.data}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),s({type:f,payload:e.t0.response.data.errors}),setTimeout((function(){return i()}),5e3);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){s({type:v})};return Object(F.jsx)(b.Provider,{value:{token:a.token,isAuthenticated:a.isAuthenticated,loading:a.loading,admin:null,error:a.error,loadAdmin:l,login:o,logout:function(){s({type:m})},clearErrors:i},children:e.children})},P=Object(c.createContext)(),G=function(e,t){switch(t.type){case g:return Object(O.a)(Object(O.a)({},e),{},{clients:t.payload,loading:!1});case y:return{clients:[],error:null,loading:!1};case C:return Object(O.a)(Object(O.a)({},e),{},{error:t.payload});case k:return Object(O.a)(Object(O.a)({},e),{},{clients:null,error:null});default:return e}},V=function(e){var t=Object(c.useReducer)(G,{clients:null,error:null,loading:!0}),n=Object(d.a)(t,2),r=n[0],a=n[1],s=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.token&&D(localStorage.token),e.prev=1,e.next=4,L.a.get("/api/clients");case 4:t=e.sent,a({type:g,payload:t.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a({type:C,payload:e.t0.response.msg});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.delete("/api/clients");case 2:a({type:y});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(F.jsx)(P.Provider,{value:{clients:r.clients,error:r.error,getClients:s,deleteClients:l,clearClients:function(){a({type:k})}},children:e.children})},B=Object(c.createContext)(),M=function(e,t){switch(t.type){case w:return Object(O.a)(Object(O.a)({},e),{},{csv:[],csvAll:t.payload[0],todaysDate:t.payload[1]});case R:return Object(O.a)(Object(O.a)({},e),{},{csv:t.payload[0],todaysDate:t.payload[1]});case _:return Object(O.a)(Object(O.a)({},e),{},{csv:[],csvAll:[],todaysDate:null});default:return e}},W=function(e){var t=Object(c.useReducer)(M,{csv:[],csvAll:[],todaysDate:null}),n=Object(d.a)(t,2),r=n[0],a=n[1],s=function(e){var t;if(", "===e)t="";else if(", "===e.slice(-2))t=e.slice(0,-2);else{if(", "!==e.substring(0,2))return e;t=e.slice(2)}return t},l=function(e){var t=new Date,n=t.getFullYear()+("0"+(t.getMonth()+1)).slice(-2)+t.getDate(),c=[["No","\u65e5\u4ed8","\u9867\u5ba2\uff03","\u62c5\u5f53","\u656c\u79f0","\u9867\u5ba2\u540d","\u696d\u754c","\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9","\u56fd\uff08\u5728\uff09","\u4f4f\u6240 line 1","\u4f4f\u6240 line 2","\u4f4f\u6240 ZIP code","\u52e4\u52d9\u5148 line 1","\u52e4\u52d9\u5148 line 2","\u52e4\u52d9\u5148 ZIP code","\u5f79\u8077","Tel.","Mobile","FAX","Tel. (Work)","Mobile (Work)","FAX (Work)","\u5099\u8003","Wanobi catalog","Catalog Home","Catalog Office","\u4f1a\u793e\u540d Company","\u30ad\u30fc\u30ef\u30fc\u30c9 Keyword"]],r=[],a=0;return e.forEach((function(e){a+=1,(r=function(e,t){for(var n=[],c=0;c<e;c++)n.push(t);return n}(28,""))[0]=a.toString(),r[5]=e.clientName,r[26]=e.company,r[8]=e.country,r[1]=e.date.slice(0,10).replaceAll("-","/"),r[7]=e.email,r[4]=e.greeting,r[3]=e.incharge,r[6]=e.industry,r[17]=e.mobile,r[22]=e.notes,r[15]=e.position,r[9]=s(e.reviewAddressLine1),r[10]=s(e.reviewAddressLine2),r[16]=e.tel,"1"===e.wanobi?r[23]="TRUE":r[23]="FALSE",c.push(r)})),[c,n]};return Object(F.jsx)(B.Provider,{value:{csv:r.csv,csvAll:r.csvAll,todaysDate:r.todaysDate,generateCsv:function(e){var t=l(e);a({type:w,payload:t})},generateCsvForOne:function(e,t){var n=l(e);a({type:R,payload:n})},clearCsv:function(){a({type:_})}},children:e.children})},q=Object(c.createContext)(),H=function(e,t){switch(t.type){case E:return Object(O.a)(Object(O.a)({},e),{},{users:t.payload,loading:!1});case N:return Object(O.a)(Object(O.a)({},e),{},{currentUser:t.payload});case S:return Object(O.a)(Object(O.a)({},e),{},{error:t.payload});case A:return Object(O.a)(Object(O.a)({},e),{},{users:null,error:null});default:return e}},J=function(e){var t=Object(c.useReducer)(H,{users:null,error:null,currentUser:null}),n=Object(d.a)(t,2),r=n[0],a=n[1],s=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.token&&D(localStorage.token),e.prev=1,e.next=4,L.a.get("/api/users");case 4:t=e.sent,a({type:E,payload:t.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a({type:S,payload:e.t0.response.msg});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return Object(F.jsx)(q.Provider,{value:{users:r.users,error:r.error,currentUser:r.currentUser,getUsers:s,clearUsers:function(){a({type:A})},setCurrentUser:function(e){a({type:N,payload:e})}},children:e.children})},X=(n(65),n(22)),Z=n(16),z=n.n(Z),K=function(){var e=Object(c.useContext)(b),t=Object(c.useContext)(q),n=Object(c.useContext)(P),r=Object(c.useContext)(B),a=e.logout,s=t.clearUsers,i=t.currentUser,u=n.clearClients,j=n.deleteClients,O=r.csvAll,p=r.csv,h=r.todaysDate,x=r.clearCsv,f=Object(o.g)(),m=Object(c.useState)(!1),v=Object(d.a)(m,2),g=v[0],y=v[1],C=Object(c.useState)(!1),k=Object(d.a)(C,2),E=k[0],N=k[1],S=Object(c.useState)(!1),A=Object(d.a)(S,2),w=A[0],R=A[1];return z.a.setAppElement("#root"),Object(F.jsxs)("div",{className:"menu",children:[Object(F.jsx)(z.a,{isOpen:g,onRequestClose:function(){return y(!1)},style:Y,children:Object(F.jsxs)("div",{className:"modal-content",children:[Object(F.jsx)("h2",{children:"Warning:"}),Object(F.jsxs)("p",{children:["Deleting all data cannot be undone.",Object(F.jsx)("br",{}),"Proceed with caution."]}),Object(F.jsx)("button",{onClick:function(){y(!1),N(!0)},children:"Proceed"}),Object(F.jsx)("button",{onClick:function(){return y(!1)},children:"Cancel"})]})}),Object(F.jsx)(z.a,{isOpen:E,onRequestClose:function(){return N(!1)},style:Y,children:Object(F.jsxs)("div",{className:"modal-content",children:[Object(F.jsx)("h2",{children:"Reset database?"}),Object(F.jsx)("button",{onClick:function(){N(!1),R(!0),u(),x(),j()},children:"Reset"}),Object(F.jsx)("button",{onClick:function(){return N(!1)},children:"Cancel"})]})}),Object(F.jsx)(z.a,{isOpen:w,onRequestClose:function(){return R(!1)},style:Y,children:Object(F.jsxs)("div",{className:"modal-content",children:[Object(F.jsx)("p",{className:"move-up",children:"Database has been reset."}),Object(F.jsx)("button",{onClick:function(){return R(!1)},children:"Close"})]})}),Object(F.jsx)("p",{children:Object(F.jsx)(l.b,{to:"/all",children:"View All"})}),Object(F.jsx)("p",{children:Object(F.jsx)(X.CSVLink,{data:O,filename:"".concat(h,"_sbk-client.csv"),children:"Download All"})}),"/clients"===f.pathname&&i&&Object(F.jsx)("p",{children:Object(F.jsx)(X.CSVLink,{data:p,filename:"".concat(h,"_sbk-client_").concat(i.split("@")[0].toUpperCase(),".csv"),children:"Download Current"})}),Object(F.jsx)("p",{onClick:function(){return y(!0)},children:"Reset Database"}),Object(F.jsx)("p",{children:Object(F.jsx)("button",{type:"button",onClick:function(){a(),s(),u(),x()},children:"Logout"})})]})},Y={overlay:{backgroundColor:"none"},content:{backgroundColor:"#d9d9d9",border:"1px solid #c7c7c7",textAlign:"center",margin:"auto",height:"40vh",width:"50vw",display:"flex",justifyContent:"center",flexDirection:"column"}},Q=function(e){var t=Object(c.useContext)(b),n=Object(c.useContext)(q),r=Object(c.useContext)(P),a=Object(c.useContext)(B),s=t.loadAdmin,o=n.users,i=n.getUsers,u=n.setCurrentUser,j=n.currentUser,d=r.clients,O=r.getClients,p=r.loading,h=a.generateCsv;Object(c.useEffect)((function(){s(),i(),O(),null!==j&&u(null)}),[]),Object(c.useEffect)((function(){d&&h(d)}),[]);var x=function(e){return d.filter((function(t){return t._partition===e._partition}))};return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(K,{}),null!==d&&null!==o&&!p&&Object(F.jsxs)("div",{className:"clients-container",children:[0===o.length?Object(F.jsx)("div",{children:"No users on file."}):Object(F.jsx)(F.Fragment,{children:o.map((function(e){return 0!==x(e).length?Object(F.jsxs)("div",{className:"view-all",children:[Object(F.jsxs)("div",{className:"clients-table",children:["User: ",e.name]}),x(e).map((function(e){return Object(F.jsxs)("div",{className:"clients-table",children:[Object(F.jsx)("div",{children:e.clientName}),Object(F.jsx)("div",{children:e.email}),Object(F.jsx)("div",{children:e.company}),Object(F.jsx)("div",{children:e.position}),Object(F.jsx)("div",{children:e.country})]},e._id)}))]},e._id):Object(F.jsxs)("div",{style:{marginTop:"2rem",marginBottom:"2rem"},children:["No clients on file for ",Object(F.jsx)("strong",{children:e.name}),"."]},e.name)}))}),Object(F.jsx)("div",{style:{marginTop:"1rem"},children:Object(F.jsx)(l.b,{to:"/",children:"\u2191 Back to Top"})})]})]})},$=function(e){var t,n=Object(c.useContext)(b),r=Object(c.useContext)(P),a=Object(c.useContext)(q),s=Object(c.useContext)(B),o=n.loadAdmin,i=r.clients,u=r.loading,j=r.getClients,d=a.users,O=a.getUsers,p=a.setCurrentUser,h=a.currentUser,x=s.generateCsv,f=s.generateCsvForOne;Object(c.useEffect)((function(){o(),O(),j(),e.location.state&&p(e.location.state.user.name)}),[]),Object(c.useEffect)((function(){if(i&&x(i),i&&d&&h){var e=d.filter((function(e){return e.name===h}))[0],t=i.filter((function(t){return t._partition===e._partition}));f(t,e.name)}}),[i,d]);var m=[];return i&&d&&null!==h&&(t=d.filter((function(e){return e.name===h}))[0],m=i.filter((function(e){return e._partition===t._partition}))),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(K,{}),null!==i&&null!==d&&!u&&null!==h&&Object(F.jsxs)("div",{className:"clients-container",children:[0===m.length?Object(F.jsxs)("div",{style:{marginBottom:"2rem"},children:["No clients on file for ",Object(F.jsxs)("strong",{children:[t.name,"."]})]}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{className:"clients-table",children:["User: ",t.name]}),m.map((function(e){return Object(F.jsxs)("div",{className:"clients-table",children:[Object(F.jsx)("div",{className:"",children:e.clientName}),Object(F.jsx)("div",{className:"",children:e.email}),Object(F.jsx)("div",{className:"",children:e.company}),Object(F.jsx)("div",{className:"",children:e.position}),Object(F.jsx)("div",{className:"",children:e.country})]},e._id)}))]}),Object(F.jsx)("div",{style:{marginTop:"1rem"},children:Object(F.jsx)(l.b,{to:"/",children:"\u2191 Back to Top"})})]})]})},ee=function(){return Object(F.jsx)("div",{className:"footer",children:Object(F.jsx)("p",{children:"\xa9 Shibunkaku Co., Ltd. 2021"})})},te=n.p+"static/media/shibunkaku_logo.4c549ebe.svg",ne=function(){var e=Object(c.useContext)(b).clearErrors;return Object(F.jsx)("div",{className:"header",id:"header",children:Object(F.jsx)(l.b,{to:"/",children:Object(F.jsx)("img",{src:te,alt:"",className:"logo",id:"logo",onClick:function(){return e()}})})})},ce=function(){var e=Object(c.useContext)(q),t=Object(c.useContext)(P),n=Object(c.useContext)(B),r=e.users,a=e.getUsers,s=e.loading,o=t.getClients,i=t.clients,u=n.generateCsv;return Object(c.useEffect)((function(){a(),o()}),[]),Object(c.useEffect)((function(){i&&u(i)}),[i]),Object(F.jsx)(F.Fragment,{children:null!==r&&!s&&Object(F.jsx)("div",{className:"container",children:Object(F.jsx)("div",{className:"user-grid",children:r.map((function(e){return Object(F.jsx)(l.b,{to:{pathname:"clients",state:{user:e}},children:Object(F.jsx)("div",{children:e.name})},e._id)}))})})})},re=function(){var e=Object(c.useContext)(b),t=Object(c.useContext)(q),n=e.loadAdmin,r=t.setCurrentUser,a=t.currentUser;return Object(c.useEffect)((function(){n(),null!==a&&r(null)}),[]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(K,{}),Object(F.jsx)(ce,{})]})},ae=n(17),se=function(){var e=Object(c.useContext)(b).error;return null!==e&&Object(F.jsx)("div",{style:{margin:"auto",fontSize:"0.8rem"},children:e[0].msg})},le=function(e){var t=Object(c.useContext)(b),n=t.login,r=t.isAuthenticated,a=Object(c.useState)({email:"",password:""}),s=Object(d.a)(a,2),l=s[0],o=s[1];Object(c.useEffect)((function(){r&&e.history.push("/")}),[r,e.history]);var i=l.email,u=l.password,j=function(e){o(Object(O.a)(Object(O.a)({},l),{},Object(ae.a)({},e.target.name,e.target.value)))};return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{className:"dummy"}),Object(F.jsxs)("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),n({email:i,password:u})},children:[Object(F.jsx)("input",{type:"text",placeholder:"Email",name:"email",value:i,onChange:j}),Object(F.jsx)("input",{type:"password",placeholder:"Password",name:"password",value:u,onChange:j}),Object(F.jsx)("input",{className:"login-btn",type:"submit",value:"Login"}),Object(F.jsx)(se,{})]})]})},oe=n(40),ie=["component"],ue=function(e){var t=e.component,n=Object(oe.a)(e,ie),r=Object(c.useContext)(b),a=r.isAuthenticated,s=r.loading;return Object(F.jsx)(o.b,Object(O.a)(Object(O.a)({},n),{},{render:function(e){return a||s?Object(F.jsx)(t,Object(O.a)({},e)):Object(F.jsx)(o.a,{to:"/login"})}}))};localStorage.token&&D(localStorage.token);var je=function(){return Object(F.jsx)("div",{className:"App",children:Object(F.jsx)(I,{children:Object(F.jsx)(J,{children:Object(F.jsx)(V,{children:Object(F.jsx)(W,{children:Object(F.jsx)(l.a,{children:Object(F.jsxs)("div",{className:"wrapper",children:[Object(F.jsx)(ne,{}),Object(F.jsxs)(o.d,{children:[Object(F.jsx)(ue,{exact:!0,path:"/",component:re}),Object(F.jsx)(ue,{exact:!0,path:"/clients",component:$}),Object(F.jsx)(ue,{exact:!0,path:"/all",component:Q}),Object(F.jsx)(o.b,{exact:!0,path:"/login",component:le})]}),Object(F.jsx)(ee,{})]})})})})})})})};s.a.render(Object(F.jsx)(r.a.StrictMode,{children:Object(F.jsx)(je,{})}),document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.314a5d0c.chunk.js.map